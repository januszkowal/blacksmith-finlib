Feature: Fx Rates

  Scenario: Scenario with EUR local currency and factors
    Given Define currency pairs
      | base | counter | cross | factor |
      #AA1-BB1
      | AA1  | EUR     | false | 1000   |
      | BB1  | EUR     | false | 100    |
      | AA1  | BB1     | true  | 1      |
      #AA2-BB2
      | AA2  | EUR     | false | 1000   |
      | BB2  | EUR     | false | 100    |
      | BB2  | AA2     | true  | 1      |
      #  AA3-BB3
      | EUR  | AA3     | false | 1000   |
      | EUR  | BB3     | false | 100    |
      | AA3  | BB3     | true  | 1      |
      #  AA4-BB4
      | EUR  | AA4     | false | 1000   |
      | EUR  | BB4     | false | 100    |
      | BB4  | AA4     | true  | 1      |
      #  AA5-BB5
      | AA5  | EUR     | false | 1000   |
      | EUR  | BB5     | false | 100    |
      | AA5  | BB5     | true  | 1      |
      #  AA6-BB6
      | AA6  | EUR     | false | 1000   |
      | EUR  | BB6     | false | 100    |
      | BB6  | AA6     | true  | 1      |
      #  AA7-BB7
      | EUR  | AA7     | false | 1000   |
      | BB7  | EUR     | false | 100    |
      | AA7  | BB7     | true  | 1      |
      #AA8-BB8
      | EUR  | AA8     | false | 1000   |
      | BB8  | EUR     | false | 100    |
      | BB8  | AA8     | true  | 1      |
    Given Source rates with precision 6
      | date       | from | to  | buy       | sell      | avg       |
      | 2021-05-10 | AA1  | EUR | 1000*2.49 | 1000*2.51 | 1000*2.50 |
      | 2021-05-10 | BB1  | EUR | 100*5.87  | 100*6.13  | 100*6.0   |
      | 2021-05-10 | AA2  | EUR | 1000*2.49 | 1000*2.51 | 1000*2.50 |
      | 2021-05-10 | BB2  | EUR | 100*5.87  | 100*6.13  | 100*6.0   |
      | 2021-05-10 | EUR  | AA3 | 1000/2.49 | 1000/2.51 | 1000/2.50 |
      | 2021-05-10 | EUR  | BB3 | 100/5.87  | 100/6.13  | 100/6.00  |
      | 2021-05-10 | EUR  | AA4 | 1000/2.49 | 1000/2.51 | 1000/2.50 |
      | 2021-05-10 | EUR  | BB4 | 100/5.87  | 100/6.13  | 100/6.00  |
      | 2021-05-10 | AA5  | EUR | 1000*2.49 | 1000*2.51 | 1000*2.50 |
      | 2021-05-10 | EUR  | BB5 | 100/5.87  | 100/6.13  | 100/6.00  |
      | 2021-05-10 | AA6  | EUR | 1000*2.49 | 1000*2.51 | 1000*2.50 |
      | 2021-05-10 | EUR  | BB6 | 100/5.87  | 100/6.13  | 100/6.00  |
      | 2021-05-10 | EUR  | AA7 | 1000/2.49 | 1000/2.51 | 1000/2.50 |
      | 2021-05-10 | BB7  | EUR | 100*5.87  | 100*6.13  | 100*6.0   |
      | 2021-05-10 | EUR  | AA8 | 1000/2.49 | 1000/2.51 | 1000/2.50 |
      | 2021-05-10 | BB8  | EUR | 100*5.87  | 100*6.13  | 100*6.0   |
    When Create service with local currency EUR and precision 6
    Then Verify output triple rates
      | date       | from | to  | buy       | sell      | avg       |
      | 2021-05-10 | AA1  | EUR | 2.49      | 2.51      | 2.50      |
      | 2021-05-10 | EUR  | AA1 | 1/2.49    | 1/2.51    | 1/2.5     |
      | 2021-05-10 | BB1  | EUR | 5.87      | 6.13      | 6.00      |
      | 2021-05-10 | EUR  | BB1 | 1/5.87    | 1/6.13    | 1/6.00    |
      | 2021-05-10 | AA1  | BB1 | 2.49/5.87 | 2.51/6.13 | 2.50/6.00 |
      | 2021-05-10 | BB1  | AA1 | 5.87/2.49 | 6.13/2.51 | 6.00/2.50 |
#
      | 2021-05-10 | AA2  | EUR | 2.49      | 2.51      | 2.50      |
      | 2021-05-10 | EUR  | AA2 | 1/2.49    | 1/2.51    | 1/2.50    |
      | 2021-05-10 | BB2  | EUR | 5.87      | 6.13      | 6.00      |
      | 2021-05-10 | EUR  | BB2 | 1/5.87    | 1/6.13    | 1/6.00    |
      | 2021-05-10 | AA2  | BB2 | 2.49/5.87 | 2.51/6.13 | 2.50/6.00 |
      | 2021-05-10 | BB2  | AA2 | 5.87/2.49 | 6.13/2.51 | 6.00/2.50 |
#
      | 2021-05-10 | AA3  | EUR | 2.49      | 2.51      | 2.50      |
      | 2021-05-10 | EUR  | AA3 | 1/2.49    | 1/2.51    | 1/2.50    |
      | 2021-05-10 | BB3  | EUR | 5.87      | 6.13      | 6.00      |
      | 2021-05-10 | EUR  | BB3 | 1/5.87    | 1/6.13    | 1/6.00    |
      | 2021-05-10 | AA3  | BB3 | 2.49/5.87 | 2.51/6.13 | 2.50/6.00 |
      | 2021-05-10 | BB3  | AA3 | 5.87/2.49 | 6.13/2.51 | 6.00/2.50 |
#
      | 2021-05-10 | AA4  | EUR | 2.49      | 2.51      | 2.50      |
      | 2021-05-10 | EUR  | AA4 | 1/2.49    | 1/2.51    | 1/2.50    |
      | 2021-05-10 | BB4  | EUR | 5.87      | 6.13      | 6.00      |
      | 2021-05-10 | EUR  | BB4 | 1/5.87    | 1/6.13    | 1/6.00    |
      | 2021-05-10 | AA4  | BB4 | 2.49/5.87 | 2.51/6.13 | 2.50/6.00 |
      | 2021-05-10 | BB4  | AA4 | 5.87/2.49 | 6.13/2.51 | 6.00/2.50 |
#
      | 2021-05-10 | AA5  | EUR | 2.49      | 2.51      | 2.50      |
      | 2021-05-10 | EUR  | AA5 | 1/2.49    | 1/2.51    | 1/2.50    |
      | 2021-05-10 | BB5  | EUR | 5.87      | 6.13      | 6.00      |
      | 2021-05-10 | EUR  | BB5 | 1/5.87    | 1/6.13    | 1/6.00    |
      | 2021-05-10 | AA5  | BB5 | 2.49/5.87 | 2.51/6.13 | 2.50/6.00 |
      | 2021-05-10 | BB5  | AA5 | 5.87/2.49 | 6.13/2.51 | 6.00/2.50 |
#
      | 2021-05-10 | AA6  | EUR | 2.49      | 2.51      | 2.50      |
      | 2021-05-10 | EUR  | AA6 | 1/2.49    | 1/2.51    | 1/2.50    |
      | 2021-05-10 | BB6  | EUR | 5.87      | 6.13      | 6.00      |
      | 2021-05-10 | EUR  | BB6 | 1/5.87    | 1/6.13    | 1/6.00    |
      | 2021-05-10 | AA6  | BB6 | 2.49/5.87 | 2.51/6.13 | 2.50/6.00 |
      | 2021-05-10 | BB6  | AA6 | 5.87/2.49 | 6.13/2.51 | 6.00/2.50 |
#
      | 2021-05-10 | AA7  | EUR | 2.49      | 2.51      | 2.50      |
      | 2021-05-10 | EUR  | AA7 | 1/2.49    | 1/2.51    | 1/2.50    |
      | 2021-05-10 | BB7  | EUR | 5.87      | 6.13      | 6.00      |
      | 2021-05-10 | EUR  | BB7 | 1/5.87    | 1/6.13    | 1/6.00    |
      | 2021-05-10 | AA7  | BB7 | 2.49/5.87 | 2.51/6.13 | 2.50/6.00 |
      | 2021-05-10 | BB7  | AA7 | 5.87/2.49 | 6.13/2.51 | 6.00/2.50 |
#
      | 2021-05-10 | AA8  | EUR | 2.49      | 2.51      | 2.50      |
      | 2021-05-10 | EUR  | AA8 | 1/2.49    | 1/2.51    | 1/2.50    |
      | 2021-05-10 | BB8  | EUR | 5.87      | 6.13      | 6.00      |
      | 2021-05-10 | EUR  | BB8 | 1/5.87    | 1/6.13    | 1/6.00    |
      | 2021-05-10 | AA8  | BB8 | 2.49/5.87 | 2.51/6.13 | 2.50/6.00 |
      | 2021-05-10 | BB8  | AA8 | 5.87/2.49 | 6.13/2.51 | 6.00/2.50 |

  Scenario: Scenario with EUR local currency and no factors
    Given Define currency pairs
      | base | counter | cross | factor |
      #AA1-BB1
      | AA1  | EUR     | false | 1      |
      | BB1  | EUR     | false | 1      |
      | AA1  | BB1     | true  | 1      |
      #AA2-BB2
      | AA2  | EUR     | false | 1      |
      | BB2  | EUR     | false | 1      |
      | BB2  | AA2     | true  | 1      |
      #  AA3-BB3
      | EUR  | AA3     | false | 1      |
      | EUR  | BB3     | false | 1      |
      | AA3  | BB3     | true  | 1      |
      #  AA4-BB4
      | EUR  | AA4     | false | 1      |
      | EUR  | BB4     | false | 1      |
      | BB4  | AA4     | true  | 1      |
      #  AA5-BB5
      | AA5  | EUR     | false | 1      |
      | EUR  | BB5     | false | 1      |
      | AA5  | BB5     | true  | 1      |
      #  AA6-BB6
      | AA6  | EUR     | false | 1      |
      | EUR  | BB6     | false | 1      |
      | BB6  | AA6     | true  | 1      |
      #  AA7-BB7
      | EUR  | AA7     | false | 1      |
      | BB7  | EUR     | false | 1      |
      | AA7  | BB7     | true  | 1      |
      #AA8-BB8
      | EUR  | AA8     | false | 1      |
      | BB8  | EUR     | false | 1      |
      | BB8  | AA8     | true  | 1      |
    Given Source rates with precision 6
      | date       | from | to  | buy    | sell   | avg    |
      | 2021-05-10 | AA1  | EUR | 2.49   | 2.51   | 2.50   |
      | 2021-05-10 | BB1  | EUR | 5.87   | 6.13   | 6.0    |
      | 2021-05-10 | AA2  | EUR | 2.49   | 2.51   | 2.50   |
      | 2021-05-10 | BB2  | EUR | 5.87   | 6.13   | 6.0    |
      | 2021-05-10 | EUR  | AA3 | 1/2.49 | 1/2.51 | 1/2.50 |
      | 2021-05-10 | EUR  | BB3 | 1/5.87 | 1/6.13 | 1/6.00 |
      | 2021-05-10 | EUR  | AA4 | 1/2.49 | 1/2.51 | 1/2.50 |
      | 2021-05-10 | EUR  | BB4 | 1/5.87 | 1/6.13 | 1/6.00 |
      | 2021-05-10 | AA5  | EUR | 2.49   | 2.51   | 2.50   |
      | 2021-05-10 | EUR  | BB5 | 1/5.87 | 1/6.13 | 1/6.00 |
      | 2021-05-10 | AA6  | EUR | 2.49   | 2.51   | 2.50   |
      | 2021-05-10 | EUR  | BB6 | 1/5.87 | 1/6.13 | 1/6.00 |
      | 2021-05-10 | EUR  | AA7 | 1/2.49 | 1/2.51 | 1/2.50 |
      | 2021-05-10 | BB7  | EUR | 5.87   | 6.13   | 6.0    |
      | 2021-05-10 | EUR  | AA8 | 1/2.49 | 1/2.51 | 1/2.50 |
      | 2021-05-10 | BB8  | EUR | 5.87   | 6.13   | 6.0    |
    When Create service with local currency EUR and precision 6
    Then Verify output triple rates
      | date       | from | to  | buy       | sell      | avg       |
      | 2021-05-10 | AA1  | EUR | 2.49      | 2.51      | 2.50      |
      | 2021-05-10 | EUR  | AA1 | 1/2.49    | 1/2.51    | 1/2.5     |
      | 2021-05-10 | BB1  | EUR | 5.87      | 6.13      | 6.00      |
      | 2021-05-10 | EUR  | BB1 | 1/5.87    | 1/6.13    | 1/6.00    |
      | 2021-05-10 | AA1  | BB1 | 2.49/5.87 | 2.51/6.13 | 2.50/6.00 |
      | 2021-05-10 | BB1  | AA1 | 5.87/2.49 | 6.13/2.51 | 6.00/2.50 |
#
      | 2021-05-10 | AA2  | EUR | 2.49      | 2.51      | 2.50      |
      | 2021-05-10 | EUR  | AA2 | 1/2.49    | 1/2.51    | 1/2.50    |
      | 2021-05-10 | BB2  | EUR | 5.87      | 6.13      | 6.00      |
      | 2021-05-10 | EUR  | BB2 | 1/5.87    | 1/6.13    | 1/6.00    |
      | 2021-05-10 | AA2  | BB2 | 2.49/5.87 | 2.51/6.13 | 2.50/6.00 |
      | 2021-05-10 | BB2  | AA2 | 5.87/2.49 | 6.13/2.51 | 6.00/2.50 |
#
      | 2021-05-10 | AA3  | EUR | 2.490003  | 2.510002  | 2.50      |
      | 2021-05-10 | EUR  | AA3 | 1/2.49    | 1/2.51    | 1/2.50    |
      | 2021-05-10 | BB3  | EUR | 5.869991  | 6.130005  | 5.999988  |
      | 2021-05-10 | EUR  | BB3 | 1/5.87    | 1/6.13    | 1/6.00    |
      | 2021-05-10 | AA3  | BB3 | 0.424192  | 0.409462  | 0.416668  |
      | 2021-05-10 | BB3  | AA3 | 2.357424  | 2.442231  | 2.399995  |
#
      | 2021-05-10 | AA4  | EUR | 2.490003  | 2.510002  | 2.50      |
      | 2021-05-10 | EUR  | AA4 | 1/2.49    | 1/2.51    | 1/2.50    |
      | 2021-05-10 | BB4  | EUR | 5.869991  | 6.130005  | 5.999988  |
      | 2021-05-10 | EUR  | BB4 | 1/5.87    | 1/6.13    | 1/6.00    |
      | 2021-05-10 | AA4  | BB4 | 0.424192  | 0.409462  | 0.416668  |
      | 2021-05-10 | BB4  | AA4 | 2.357424  | 2.442231  | 2.399995  |
#
      | 2021-05-10 | AA5  | EUR | 2.49      | 2.51      | 2.50      |
      | 2021-05-10 | EUR  | AA5 | 1/2.49    | 1/2.51    | 1/2.50    |
      | 2021-05-10 | BB5  | EUR | 5.869991  | 6.130005  | 5.999988  |
      | 2021-05-10 | EUR  | BB5 | 1/5.87    | 1/6.13    | 1/6.00    |
      | 2021-05-10 | AA5  | BB5 | 0.424191  | 0.409461  | 0.416668  |
      | 2021-05-10 | BB5  | AA5 | 2.357426  | 2.442233  | 2.399995  |
#
      | 2021-05-10 | AA6  | EUR | 2.49      | 2.51      | 2.50      |
      | 2021-05-10 | EUR  | AA6 | 1/2.49    | 1/2.51    | 1/2.50    |
      | 2021-05-10 | BB6  | EUR | 5.869991  | 6.130005  | 5.999988  |
      | 2021-05-10 | EUR  | BB6 | 1/5.87    | 1/6.13    | 1/6.00    |
      | 2021-05-10 | AA6  | BB6 | 0.424191  | 0.409461  | 0.416668  |
      | 2021-05-10 | BB6  | AA6 | 2.357426  | 2.442233  | 2.399995  |
#
      | 2021-05-10 | AA7  | EUR | 2.490003  | 2.510002  | 2.50      |
      | 2021-05-10 | EUR  | AA7 | 1/2.49    | 1/2.51    | 1/2.50    |
      | 2021-05-10 | BB7  | EUR | 5.87      | 6.13      | 6.00      |
      | 2021-05-10 | EUR  | BB7 | 1/5.87    | 1/6.13    | 1/6.00    |
      | 2021-05-10 | AA7  | BB7 | 2.49/5.87 | 2.51/6.13 | 2.50/6.00 |
      | 2021-05-10 | BB7  | AA7 | 2.357427  | 2.442229  | 2.4       |
#
      | 2021-05-10 | AA8  | EUR | 2.490003  | 2.510002  | 2.50      |
      | 2021-05-10 | EUR  | AA8 | 1/2.49    | 1/2.51    | 1/2.50    |
      | 2021-05-10 | BB8  | EUR | 5.87      | 6.13      | 6.00      |
      | 2021-05-10 | EUR  | BB8 | 1/5.87    | 1/6.13    | 1/6.00    |
      | 2021-05-10 | AA8  | BB8 | 2.49/5.87 | 2.51/6.13 | 2.50/6.00 |
      | 2021-05-10 | BB8  | AA8 | 2.357427  | 2.442229  | 2.4       |
