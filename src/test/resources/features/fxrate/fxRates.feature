Feature: Fx Rates

  Scenario: Scenario with EUR local currency and no factors
    Given Define currency pairs
      | base | counter | cross | factor |
      | EUR  | USD     | false | 1      |
      | EUR  | JPY     | false | 1      |
      | EUR  | HUF     | false | 1      |
      | EUR  | PLN     | false | 1      |
      | USD  | PLN     | true  | 1      |
      | USD  | JPY     | true  | 1      |
      | USD  | HUF     | true  | 1      |
      | JPY  | HUF     | true  | 1      |
      | JPY  | PLN     | true  | 1      |
      | HUF  | PLN     | true  | 1      |
    Given Source rates with precision 6
      | date       | from | to  | buy     | sell    | avg     |
      | 2021-05-15 | EUR  | USD | 1.21    | 1.22    | 1.215   |
      | 2021-05-15 | EUR  | JPY | 132.82  | 132.88  | 132.85  |
      | 2021-05-15 | EUR  | HUF | 348.550 | 348.569 | 348.669 |
      | 2021-05-15 | EUR  | PLN | 4.5     | 4.6d    | 4.55    |
    When Create service with local currency EUR and precision 6
    Then Verify output triple rates
      | date       | from | to  | buy            | sell           | avg            |
      | 2021-05-15 | EUR  | HUF | 348.550        | 348.569        | 348.669        |
      | 2021-05-15 | EUR  | JPY | 132.82         | 132.88         | 132.85         |
      | 2021-05-15 | EUR  | PLN | 4.5            | 4.6            | 4.55           |
      | 2021-05-15 | EUR  | USD | 1.21           | 1.22           | 1.215          |
      | 2021-05-15 | HUF  | EUR | 1/348.550      | 1/348.569      | 1/348.669      |
      | 2021-05-15 | HUF  | JPY | 132.82/348.550 | 132.88/348.569 | 132.85/348.669 |
      | 2021-05-15 | HUF  | PLN | 4.5/348.550    | 4.6/348.569    | 4.55/348.669   |
      | 2021-05-15 | HUF  | USD | 1.21/348.550   | 1.22/348.569   | 1.215/348.669  |
      | 2021-05-15 | JPY  | EUR | 1/132.82       | 1/132.88       | 1/132.85       |
      | 2021-05-15 | JPY  | HUF | 348.550/132.82 | 348.569/132.88 | 348.669/132.85 |
      | 2021-05-15 | JPY  | PLN | 4.5/132.82     | 4.6/132.88     | 4.55/132.85    |
      | 2021-05-15 | JPY  | USD | 1.21/132.82    | 1.22/132.88    | 1.215/132.85   |
      | 2021-05-15 | PLN  | EUR | 1/4.5          | 1/4.6          | 1/4.55         |
      | 2021-05-15 | PLN  | HUF | 348.550/4.5    | 348.569/4.6    | 348.669/4.55   |
      | 2021-05-15 | PLN  | JPY | 132.82/4.5     | 132.88/4.6     | 132.85/4.55    |
      | 2021-05-15 | PLN  | USD | 1.21/4.5       | 1.22/4.6       | 1.215/4.55     |
      | 2021-05-15 | USD  | EUR | 1/1.21         | 1/1.22         | 1/1.215        |
      | 2021-05-15 | USD  | HUF | 348.550/1.21   | 348.569/1.22   | 348.669/1.215  |
      | 2021-05-15 | USD  | JPY | 132.82/1.21    | 132.88/1.22    | 132.85/1.215   |
      | 2021-05-15 | USD  | PLN | 4.5/1.21       | 4.6/1.22       | 4.55/1.215     |

  Scenario: Scenario with PLN local currency and factors
    Given Define currency pairs
      | base | counter | cross | factor |
      | EUR  | PLN     | false | 1      |
      | USD  | PLN     | false | 1      |
      | JPY  | PLN     | false | 100    |
      | HUF  | PLN     | false | 100    |
      | EUR  | USD     | true  | 1      |
      | EUR  | HUF     | true  | 1      |
      | EUR  | JPY     | true  | 1      |
      | USD  | HUF     | true  | 1      |
      | USD  | JPY     | true  | 1      |
      | JPY  | HUF     | true  | 1      |
    Given Source rates with precision 6
      | date       | from | to  | buy    | sell   | avg    |
      | 2021-05-15 | EUR  | PLN | 4.5    | 4.6d   | 4.55   |
      | 2021-05-15 | USD  | PLN | 3.74   | 3.76   | 3.75   |
      | 2021-05-15 | HUF  | PLN | 1.2863 | 1.2865 | 1.2864 |
      | 2021-05-15 | JPY  | PLN | 3.4249 | 3.4251 | 3.4250 |
    When Create service with local currency PLN and precision 6
    Then Verify output triple rates
      | date       | from | to  | buy               | sell              | avg               |
      | 2021-05-15 | EUR  | HUF | 100*4.5/1.2863    | 100*4.6/1.2865    | 100*4.55/1.2864   |
      | 2021-05-15 | EUR  | JPY | 100*4.5/3.4249    | 100*4.6/3.4251    | 100*4.55/3.4250   |
      | 2021-05-15 | EUR  | PLN | 4.5               | 4.6               | 4.55              |
      | 2021-05-15 | EUR  | USD | 4.5/3.74          | 4.6/3.76          | 4.55/3.75         |
      | 2021-05-15 | HUF  | EUR | 1.2863/(4.5*100)  | 1.2865/(4.6*100)  | 1.2864/(4.55*100) |
      | 2021-05-15 | HUF  | JPY | 1.2863/3.4249     | 1.2865/3.4251     | 1.2864/3.4250     |
      | 2021-05-15 | HUF  | PLN | 1.2863/100        | 1.2865/100        | 1.2864/100        |
      | 2021-05-15 | HUF  | USD | 1.2863/(100*3.74) | 1.2865/(100*3.76) | 1.2864/(100*3.75) |
      | 2021-05-15 | JPY  | EUR | 3.4249/(100*4.5)  | 3.4251/(100*4.6)  | 3.4250/(100*4.55) |
      | 2021-05-15 | JPY  | HUF | 3.4249/1.2863     | 3.4251/1.2865     | 3.4250/1.2864     |
      | 2021-05-15 | JPY  | PLN | 3.4249/100        | 3.4251/100        | 3.4250/100        |
      | 2021-05-15 | JPY  | USD | 3.4249/(100*3.74) | 3.4251/(100*3.76) | 3.4250/(100*3.75) |
      | 2021-05-15 | PLN  | EUR | 1/4.5             | 1/4.6             | 1/4.55            |
      | 2021-05-15 | PLN  | HUF | 100/1.2863        | 100/1.2865        | 100/1.2864        |
      | 2021-05-15 | PLN  | USD | 1/3.74            | 1/3.76            | 1/3.75            |
      | 2021-05-15 | PLN  | JPY | 1/0.034249        | 100/3.4251        | 100/3.4250        |
      | 2021-05-15 | USD  | EUR | 3.74/4.5          | 3.76/4.6          | 3.75/4.55         |
      | 2021-05-15 | USD  | HUF | 100*3.74/1.2863   | 100*3.76/1.2865   | 100*3.75/1.2864   |
      | 2021-05-15 | USD  | PLN | 3.74              | 3.76              | 3.75              |
      | 2021-05-15 | USD  | JPY | 100*3.74/3.4249   | 100*3.76/3.4251   | 100*3.75/3.4250   |
